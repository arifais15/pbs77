(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{1120:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var s=a(5155),r=a(2115),i=a(4269);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});n.displayName="Textarea"},1186:(e,t,a)=>{"use strict";a.d(t,{bq:()=>m,eb:()=>h,gC:()=>x,l6:()=>c,yv:()=>u});var s=a(5155),r=a(2115),i=a(2912),n=a(9007),l=a(2614),d=a(2251),o=a(4269);let c=i.bL;i.YJ;let u=i.WT,m=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(i.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,s.jsx)(i.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=i.l9.displayName;let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})});f.displayName=i.PP.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=i.wn.displayName;let x=r.forwardRef((e,t)=>{let{className:a,children:r,position:n="popper",...l}=e;return(0,s.jsx)(i.ZL,{children:(0,s.jsxs)(i.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...l,children:[(0,s.jsx)(f,{}),(0,s.jsx)(i.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(p,{})]})})});x.displayName=i.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=i.JU.displayName;let h=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(i.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(i.VF,{children:(0,s.jsx)(d.A,{className:"h-4 w-4"})})}),(0,s.jsx)(i.p4,{children:r})]})});h.displayName=i.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=i.wv.displayName},3998:(e,t,a)=>{"use strict";a.d(t,{$:()=>o,r:()=>d});var s=a(5155),r=a(2115),i=a(7129),n=a(3101),l=a(4269);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:o=!1,...c}=e,u=o?i.DX:"button";return(0,s.jsx)(u,{className:(0,l.cn)(d({variant:r,size:n,className:a})),ref:t,...c})});o.displayName="Button"},4821:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ea});var s=a(5155),r=a(2115),i=a(63),n=a(3998),l=a(6948),d=a(7270),o=a(3101),c=a(4269);let u=(0,o.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function m(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,c.cn)(u({variant:a}),t),...r})}var f=a(7599);let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(f.bL,{className:(0,c.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...r,ref:t,children:(0,s.jsx)(f.zi,{className:(0,c.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});p.displayName=f.bL.displayName;var x=a(5142),h=a(2033),g=a(9201),b=a(6204),j=a(2452),v=a(3630),y=a(8772),N=a(406),w=a(6251),A=a(5894),C=a(2619),S=a.n(C),T=a(2052),R=a(9708),k=a(7283),D=a(6615);let E=k.bL,F=k.l9,I=k.ZL;k.bm;let U=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(k.hJ,{ref:t,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});U.displayName=k.hJ.displayName;let _=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(I,{children:[(0,s.jsx)(U,{}),(0,s.jsxs)(k.UC,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...i,children:[r,(0,s.jsxs)(k.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(D.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});_.displayName=k.UC.displayName;let B=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};B.displayName="DialogHeader";let V=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};V.displayName="DialogFooter";let H=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(k.hE,{ref:t,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});H.displayName=k.hE.displayName;let z=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(k.VY,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...r})});z.displayName=k.VY.displayName;var O=a(6463);let P=O.bL,J=O.l9,L=O.ZL,M=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(O.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});M.displayName=O.hJ.displayName;let Z=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(L,{children:[(0,s.jsx)(M,{}),(0,s.jsx)(O.UC,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});Z.displayName=O.UC.displayName;let $=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};$.displayName="AlertDialogHeader";let q=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};q.displayName="AlertDialogFooter";let Y=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(O.hE,{ref:t,className:(0,c.cn)("text-lg font-semibold",a),...r})});Y.displayName=O.hE.displayName;let G=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(O.VY,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...r})});G.displayName=O.VY.displayName;let W=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(O.rc,{ref:t,className:(0,c.cn)((0,n.r)(),a),...r})});W.displayName=O.rc.displayName;let X=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(O.ZD,{ref:t,className:(0,c.cn)((0,n.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});X.displayName=O.ZD.displayName;var K=a(6444),Q=a(1186),ee=a(9253),et=a(1120);function ea(){let e=(0,i.useRouter)(),{toast:t}=(0,A.dj)(),{user:a,isUserLoading:o}=(0,T.useUser)(),c=(0,T.useFirestore)(),u=(0,T.useMemoFirebase)(()=>c&&a?(0,R.rJ)(c,"users"):null,[c,a]),{data:f,isLoading:C}=(0,T.useCollection)(u),k=(0,T.useMemoFirebase)(()=>c&&a?(0,R.P)((0,R.rJ)(c,"letter-activities"),(0,R.My)("date","desc"),(0,R.AB)(100)):null,[c,a]),{data:D,isLoading:I}=(0,T.useCollection)(k),[U,O]=(0,r.useState)(""),[L,M]=(0,r.useState)(""),[ea,es]=(0,r.useState)("user"),[er,ei]=(0,r.useState)(!1),[en,el]=(0,r.useState)(!1),[ed,eo]=(0,r.useState)(!1),[ec,eu]=(0,r.useState)(""),[em,ef]=(0,r.useState)(!1),[ep,ex]=(0,r.useState)(!1),[eh,eg]=(0,r.useState)(!1);(0,r.useEffect)(()=>{eo(!0),!o&&a?"admin"!==sessionStorage.getItem("userRole")&&(t({variant:"destructive",title:"Access Denied",description:"You must be an admin to view this page."}),e.push("/dashboard")):o||a||e.push("/")},[e,t,a,o]);let eb=async(e,a)=>{if(!c)return;let s=(0,R.H9)(c,"users",e);try{await (0,R.BN)(s,{status:a?"active":"inactive"},{merge:!0}),t({title:"User status updated",description:"User status has been changed."})}catch(e){t({variant:"destructive",title:"Error",description:"Failed to update user status."})}},ej=async(e,a,s)=>{if(!s||!s.includes("@"))return void t({variant:"destructive",title:"Invalid Email",description:"Please enter a valid email address."});if(!c)return;let r=(0,R.H9)(c,"users",e);try{await (0,R.BN)(r,{email:s},{merge:!0}),t({title:"User email updated in DB",description:"User email for ".concat(a," is now ").concat(s,". Auth email not changed.")})}catch(e){t({variant:"destructive",title:"Error",description:"Failed to update user email."})}},ev=async()=>{if(!c)return void t({variant:"destructive",title:"Error",description:"Database not available."});if(!U||!L)return void t({variant:"destructive",title:"Missing Fields",description:"Please provide email and password."});ei(!0);let e=(0,ee.xI)();try{let a=(await (0,ee.eJ)(e,U,L)).user,s=(0,R.H9)(c,"users",a.uid);await (0,R.BN)(s,{id:a.uid,email:U,role:ea,status:"active"}),t({title:"User Created",description:"".concat(U," has been added successfully.")}),O(""),M(""),es("user"),el(!1)}catch(e){console.error("Error creating user:",e),t({variant:"destructive",title:"Creation Failed",description:e.message||"Could not create user."})}finally{ei(!1)}},ey=async(e,a)=>{if(c&&window.confirm("Are you sure you want to delete user ".concat(a,"? This action cannot be undone.")))try{await (0,R.kd)((0,R.H9)(c,"users",e)),t({title:"User Deleted from Firestore",description:"User ".concat(a," has been removed from the database.")})}catch(e){t({variant:"destructive",title:"Error",description:"Failed to delete user."})}},eN=async(e,a)=>{if(c&&window.confirm("Are you sure you want to delete the activity for ".concat(a,"? This action cannot be undone.")))try{await (0,R.kd)((0,R.H9)(c,"letter-activities",e)),t({title:"Activity Deleted",description:"The activity log has been removed from the database."})}catch(e){t({variant:"destructive",title:"Error",description:"Failed to delete activity."})}},ew=async()=>{if(!c||!ec)return void t({variant:"destructive",title:"Error",description:"Database not available or no CSV data provided."});ef(!0);try{var e;let a=ec.trim().split("\n");if(0===a.length)return void t({variant:"destructive",title:"Import Error",description:"CSV data is empty."});let s=(null==(e=a.shift())?void 0:e.trim().toLowerCase().split(",").map(e=>e.trim()))||[],r=["accno","name","guardian","address","mobile","meterno","tarrif"];if(!r.every(e=>s.includes(e))){t({variant:"destructive",title:"Invalid Headers",description:"CSV must contain these headers: ".concat(r.join(", "))}),ef(!1);return}for(let e=0;e<a.length;e+=500){let t=(0,R.wP)(c);a.slice(e,e+500).forEach(e=>{let a=e.split(","),r={};s.forEach((e,t)=>{var s;r[e]=(null==(s=a[t])?void 0:s.trim())||""});let i=r.accno;if(i){let e={name:r.name||"",guardian:r.guardian||"",address:r.address||"",mobile:r.mobile||"",meterNo:r.meterno||"",tarrif:r.tarrif||""},a=(0,R.H9)(c,"consumers",i);t.set(a,e)}}),await t.commit()}t({title:"Import Successful",description:"".concat(a.length," consumer records have been imported.")}),eu(""),eg(!1)}catch(e){console.error("Error importing consumers:",e),t({variant:"destructive",title:"Import Failed",description:e.message||"An unexpected error occurred during import."})}finally{ef(!1)}},eA=async()=>{if(!c)return void t({variant:"destructive",title:"Error",description:"Database not available."});ex(!0);try{let e=(0,R.rJ)(c,"consumers"),a=await (0,R.GG)(e);if(a.empty){t({title:"No Data",description:"There are no consumer records to delete."}),ex(!1);return}for(let e=0;e<a.docs.length;e+=500){let t=(0,R.wP)(c);a.docs.slice(e,e+500).forEach(e=>t.delete(e.ref)),await t.commit()}t({title:"Deletion Successful",description:"All ".concat(a.size," consumer records have been deleted.")})}catch(e){console.error("Error deleting consumers:",e),t({variant:"destructive",title:"Deletion Failed",description:e.message||"An unexpected error occurred during deletion."})}finally{ex(!1)}};return!ed||o?(0,s.jsx)("div",{className:"p-8",children:(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)(h.A,{className:"h-8 w-8 animate-spin"})})}):(0,s.jsxs)("div",{className:"p-4 sm:p-6 md:p-8 space-y-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center no-print-area",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[(0,s.jsx)(g.A,{className:"h-8 w-8 text-primary"})," Admin Dashboard"]}),(0,s.jsx)(n.$,{asChild:!0,children:(0,s.jsxs)(S(),{href:"/dashboard",children:[(0,s.jsx)(b.A,{className:"mr-2 h-4 w-4"})," Go to Dashboard"]})})]}),(0,s.jsxs)(l.Zp,{className:"no-print-area",children:[(0,s.jsxs)(l.aR,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ZB,{children:"User Management"}),(0,s.jsx)(l.BT,{children:"Create, manage, and remove user accounts."})]}),(0,s.jsxs)(E,{open:en,onOpenChange:el,children:[(0,s.jsx)(F,{asChild:!0,children:(0,s.jsxs)(n.$,{children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4"})," Add User"]})}),(0,s.jsxs)(_,{children:[(0,s.jsxs)(B,{children:[(0,s.jsx)(H,{children:"Add a New User"}),(0,s.jsx)(z,{children:"Create a new user account and add it to Firestore. The user will be created in Firebase Authentication."})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(K.J,{htmlFor:"email",className:"text-right",children:"Email"}),(0,s.jsx)(x.p,{id:"email",value:U,onChange:e=>O(e.target.value),className:"col-span-3"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(K.J,{htmlFor:"password",className:"text-right",children:"Password"}),(0,s.jsx)(x.p,{id:"password",type:"password",value:L,onChange:e=>M(e.target.value),className:"col-span-3"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(K.J,{htmlFor:"role",className:"text-right",children:"Role"}),(0,s.jsxs)(Q.l6,{onValueChange:e=>es(e),defaultValue:"user",children:[(0,s.jsx)(Q.bq,{className:"col-span-3",children:(0,s.jsx)(Q.yv,{placeholder:"Select a role"})}),(0,s.jsxs)(Q.gC,{children:[(0,s.jsx)(Q.eb,{value:"user",children:"User"}),(0,s.jsx)(Q.eb,{value:"admin",children:"Admin"})]})]})]})]}),(0,s.jsx)(V,{children:(0,s.jsxs)(n.$,{onClick:ev,disabled:er,children:[er&&(0,s.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Create User"]})})]})]})]}),(0,s.jsx)(l.Wu,{children:(0,s.jsxs)(d.XI,{children:[(0,s.jsx)(d.A0,{children:(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nd,{children:"Email"}),(0,s.jsx)(d.nd,{children:"Role"}),(0,s.jsx)(d.nd,{children:"Status"}),(0,s.jsx)(d.nd,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(d.BF,{children:f&&f.map(e=>(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nA,{className:"font-medium",children:(0,s.jsx)(x.p,{type:"email",defaultValue:e.email,onBlur:t=>ej(e.id,e.email,t.target.value),disabled:"admin"===e.role,className:"w-full sm:w-auto"})}),(0,s.jsx)(d.nA,{children:(0,s.jsx)(m,{variant:"admin"===e.role?"default":"secondary",children:e.role})}),(0,s.jsx)(d.nA,{children:(0,s.jsx)(m,{variant:"active"===e.status?"outline":"destructive",children:e.status})}),(0,s.jsxs)(d.nA,{className:"text-right space-x-2",children:[(0,s.jsx)(p,{checked:"active"===e.status,onCheckedChange:t=>eb(e.id,t),disabled:"admin"===e.role,"aria-label":"Activate or deactivate user ".concat(e.email)}),(0,s.jsx)(n.$,{variant:"destructive",size:"icon",onClick:()=>ey(e.id,e.email),disabled:"admin"===e.role,"aria-label":"Delete user ".concat(e.email),children:(0,s.jsx)(v.A,{className:"h-4 w-4"})})]})]},e.id))})]})})]}),(0,s.jsxs)(l.Zp,{className:"no-print-area",children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsx)(l.ZB,{children:"Consumer Data Management"}),(0,s.jsx)(l.BT,{children:"Import new consumer data from a CSV or delete all existing records."})]}),(0,s.jsxs)(l.Wu,{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)(E,{open:eh,onOpenChange:eg,children:[(0,s.jsx)(F,{asChild:!0,children:(0,s.jsxs)(n.$,{variant:"outline",children:[(0,s.jsx)(y.A,{className:"mr-2 h-4 w-4"})," Import Consumers from CSV"]})}),(0,s.jsxs)(_,{className:"sm:max-w-xl",children:[(0,s.jsxs)(B,{children:[(0,s.jsx)(H,{children:"Import Consumer Data"}),(0,s.jsxs)(z,{children:["Paste your CSV content below. The first row must be a header with the following columns (case-insensitive):",(0,s.jsx)("code",{className:"block bg-muted p-2 rounded-md my-2 text-sm",children:"accNo,name,guardian,address,mobile,meterNo,tarrif"}),"The `accNo` will be used as the unique ID for each consumer. ",(0,s.jsx)("strong",{children:"Important:"})," For large datasets (> 5,000 records), using this tool may exceed your daily Firebase quota. It is highly recommended to use a server-side script with the Firebase Admin SDK for bulk importing large amounts of data."]})]}),(0,s.jsx)(et.T,{placeholder:"Paste CSV data here...",className:"h-64",value:ec,onChange:e=>eu(e.target.value),disabled:em}),(0,s.jsx)(V,{children:(0,s.jsxs)(n.$,{onClick:ew,disabled:em||!ec,children:[em&&(0,s.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Start Import"]})})]})]}),(0,s.jsxs)(P,{children:[(0,s.jsx)(J,{asChild:!0,children:(0,s.jsxs)(n.$,{variant:"destructive",disabled:ep,children:[ep?(0,s.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Delete All Consumer Data"]})}),(0,s.jsxs)(Z,{children:[(0,s.jsxs)($,{children:[(0,s.jsxs)(Y,{className:"flex items-center gap-2",children:[(0,s.jsx)(N.A,{className:"text-destructive"})," Are you absolutely sure?"]}),(0,s.jsxs)(G,{children:["This action cannot be undone. This will permanently delete all consumer documents. ",(0,s.jsx)("strong",{children:"Important:"})," This operation performs one delete for every consumer record and can easily exhaust your Firebase daily quota, causing the operation to fail partway through. For datasets over 5,000 records, performing this from a server-side script using the Firebase Admin SDK is strongly recommended for reliability."]})]}),(0,s.jsxs)(q,{children:[(0,s.jsx)(X,{children:"Cancel"}),(0,s.jsx)(W,{onClick:eA,className:"bg-destructive hover:bg-destructive/90",children:"Confirm & Delete All"})]})]})]})]})]}),(0,s.jsxs)(l.Zp,{className:"print-area",children:[(0,s.jsxs)(l.aR,{className:"flex flex-row items-center justify-between no-print-area",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ZB,{children:"Letter Generation Activity"}),(0,s.jsx)(l.BT,{children:"View a log of all letters and applications generated by users."})]}),(0,s.jsxs)(n.$,{onClick:()=>{window.print()},variant:"outline",children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4"})," Print Log"]})]}),(0,s.jsx)(l.Wu,{children:(0,s.jsxs)(d.XI,{children:[(0,s.jsx)(d.A0,{children:(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nd,{children:"Account No."}),(0,s.jsx)(d.nd,{children:"Consumer Name"}),(0,s.jsx)(d.nd,{children:"Subject"}),(0,s.jsx)(d.nd,{children:"Created By"}),(0,s.jsx)(d.nd,{children:"Date"}),(0,s.jsx)(d.nd,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(d.BF,{children:I?(0,s.jsx)(d.Hj,{children:(0,s.jsx)(d.nA,{colSpan:6,className:"text-center py-8",children:(0,s.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,s.jsx)(h.A,{className:"h-5 w-5 animate-spin"}),(0,s.jsx)("span",{children:"Loading activity log..."})]})})}):D&&D.length>0?D.map(e=>(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nA,{className:"font-mono",children:e.accountNumber}),(0,s.jsx)(d.nA,{children:e.consumerName}),(0,s.jsx)(d.nA,{children:e.subject}),(0,s.jsx)(d.nA,{children:e.createdBy}),(0,s.jsx)(d.nA,{children:e.date}),(0,s.jsx)(d.nA,{className:"text-right",children:(0,s.jsx)(n.$,{variant:"destructive",size:"icon",onClick:()=>eN(e.id,e.consumerName),"aria-label":"Delete activity for ".concat(e.consumerName),children:(0,s.jsx)(v.A,{className:"h-4 w-4"})})})]},e.id)):(0,s.jsx)(d.Hj,{children:(0,s.jsx)(d.nA,{colSpan:6,className:"text-center py-8",children:"No activity recorded yet."})})})]})})]})]})}},5142:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(5155),r=a(2115),i=a(4269);let n=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});n.displayName="Input"},5894:(e,t,a)=>{"use strict";a.d(t,{dj:()=>u});var s=a(2115);let r=0,i=new Map,n=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},l=[],d={toasts:[]};function o(e){d=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(d,e),l.forEach(e=>{e(d)})}function c(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>o({type:"DISMISS_TOAST",toastId:a});return o({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function u(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},6444:(e,t,a)=>{"use strict";a.d(t,{J:()=>o});var s=a(5155),r=a(2115),i=a(489),n=a(3101),l=a(4269);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.b,{ref:t,className:(0,l.cn)(d(),a),...r})});o.displayName=i.b.displayName},6948:(e,t,a)=>{"use strict";a.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>l});var s=a(5155),r=a(2115),i=a(4269);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});n.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...r})});l.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...r})});c.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},7270:(e,t,a)=>{"use strict";a.d(t,{A0:()=>l,BF:()=>d,Hj:()=>o,XI:()=>n,nA:()=>u,nd:()=>c});var s=a(5155),r=a(2115),i=a(4269);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",a),...r})})});n.displayName="Table";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",a),...r})});l.displayName="TableHeader";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",a),...r})});d.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});o.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("th",{ref:t,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});c.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("td",{ref:t,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"},9822:(e,t,a)=>{Promise.resolve().then(a.bind(a,4821))}},e=>{e.O(0,[992,644,955,667,116,998,232,441,255,358],()=>e(e.s=9822)),_N_E=e.O()}]);